{% extends "ledger/base.html" %}
{% block content %}
<h1>История транзакций</h1>
<table class="table table-sm">
  <thead><tr>
    <th>Дата</th><th>Описание</th>
    <th>Дебет</th><th>Кредит</th><th class="text-end">Сумма</th><th></th>
  </tr></thead>
  <tbody>
    {% for t in transactions %}
    <tr class="{% if t.is_reversal %}table-warning{% endif %}{% if t.annulled %} table-secondary{% endif %}">
      <td>{{ t.created_at|date:"Y-m-d H:i" }}</td>
      <td>{{ t.description }}</td>
      <td>{{ t.debit_account.number }} — {{ t.debit_account.name }}</td>
      <td>{{ t.credit_account.number }} — {{ t.credit_account.name }}</td>
      <td class="text-end">{{ t.amount }}</td>
      <td class="text-end">
        {% if not t.annulled and not t.is_reversal %}
          <form method="post" action="{% url 'ledger:transaction_annul' t.pk %}">
            {% csrf_token %}
            <button class="btn btn-sm btn-outline-danger">Сторнировать</button>
          </form>
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
